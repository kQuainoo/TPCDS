{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2023-12-29T02:08:16.798525Z", "invocation_id": "11f34597-d75f-4fb1-b539-798b499cca60", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:15.903717Z", "completed_at": "2023-12-29T02:08:15.916867Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:15.918471Z", "completed_at": "2023-12-29T02:08:15.918490Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018292665481567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.stg_tpcds__catalog_sales", "compiled": true, "compiled_code": "select \n    CS_WAREHOUSE_SK AS WAREHOUSE_SK, \n    CS_SHIP_DATE_SK AS SHIP_DATE_SK, \n    CS_EXT_LIST_PRICE AS EXT_LIS, \n    CS_QUANTITY AS QUANTITY, \n    CS_NET_PAID_INC_TAX AS NET_PAID_INC_TAX, \n    CS_SOLD_TIME_SK AS SOLD_TIME_SK, \n    CS_PROMO_SK AS PROMO_SK, \n    CS_LIST_PRICE AS LIST_PRICE, \n    CS_EXT_SHIP_COST AS EXT_SHIP_COST, \n    CS_NET_PAID AS NET_PAID, \n    CS_SOLD_DATE_SK AS SOLD_DATE_SK, \n    CS_EXT_DISCOUNT_AMT AS EXT_DISCOUNT_AMT, \n    CS_SHIP_ADDR_SK AS SHIP_ADDR_SK, \n    CS_EXT_TAX AS EXT_TAX, \n    CS_CATALOG_PAGE_SK AS CATALOG_PAGE_SK, \n    CS_NET_PROFIT AS NET_PROFIT, \n    CS_ITEM_SK AS ITEM_SK, \n    CS_BILL_CDEMO_SK AS BILL_CDEMO_SK, \n    CS_BILL_HDEMO_SK AS BILL_HDEMO_SK, \n    CS_NET_PAID_INC_SHIP AS NET_PAID_INC_SHIP, \n    CS_COUPON_AMT AS COUPON_AMT, \n    CS_NET_PAID_INC_SHIP_TAX AS NET_PAID_INC_SHIP_TAX, \n    CS_ORDER_NUMBER AS ORDER_NUMBER, \n    CS_EXT_WHOLESALE_COST AS EXT_WHOLESALE_COST, \n    CS_SHIP_MODE_SK AS SHIP_MODE_SK, \n    CS_EXT_SALES_PRICE AS EXT_SALES_PRICE, \n    CS_SHIP_CUSTOMER_SK AS SHIP_CUSTOMER, \n    CS_BILL_ADDR_SK AS BILL_ADDR_SK, \n    CS_SHIP_CDEMO_SK AS SHIP_CDEMO_SK, \n    CS_SHIP_HDEMO_SK AS SHIP_HDEMO_SK, \n    CS_WHOLESALE_COST AS WHOLESALE_COST, \n    CS_SALES_PRICE AS SALES_PRICE, \n    CS_CALL_CENTER_SK AS CALL_CENTER_SK, \n    CS_BILL_CUSTOMER_SK AS BILL_CUSTOMER_SK, \n    _AIRBYTE_NORMALIZED_AT AS DATETIMESTAMP\nfrom TPCDS.RAW.catalog_sales", "relation_name": "dbt_tpcds.staging.stg_tpcds__catalog_sales"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:15.923316Z", "completed_at": "2023-12-29T02:08:15.928859Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:15.930470Z", "completed_at": "2023-12-29T02:08:15.930481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010114192962646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.stg_tpcds__customer", "compiled": true, "compiled_code": "SELECT \n    C_SALUTATION AS SALUTATION, \n    C_PREFERRED_CUST_FLAG AS PREFERRED_CUST_FLAG,  \n    C_FIRST_SALES_DATE_SK AS FIRST_SALES_DATE_SK, \n    C_CUSTOMER_SK AS CUSTOMER_SK, \n    C_LOGIN AS CUSTOMER_LOGIN, \n    C_CURRENT_CDEMO_SK AS CURRENT_CDEMO_SK, \n    C_FIRST_NAME AS FIRST_NAME, \n    C_CURRENT_HDEMO_SK AS CURRENT_HDEMO, \n    C_CURRENT_ADDR_SK AS CURRENT_ADDR_SK, \n    C_LAST_NAME AS LAST_NAME , \n    C_CUSTOMER_ID AS CUSTOMER_ID, \n    C_LAST_REVIEW_DATE_SK AS LAST_REVIEW_DATE_SK, \n    C_BIRTH_MONTH AS BIRTH_MONTH, \n    C_BIRTH_COUNTRY AS BIRTH_COUNTRY, \n    C_BIRTH_YEAR AS BIRTH_YEAR, \n    C_BIRTH_DAY AS BIRTH_DAY, \n    C_EMAIL_ADDRESS AS EMAIL_ADDRESS, \n    C_FIRST_SHIPTO_DATE_SK AS FIRST_SHIPTO_DATE_SK, \n    _AIRBYTE_NORMALIZED_AT AS DATETIMESTAMP\nFROM TPCDS.RAW.customer", "relation_name": "dbt_tpcds.staging.stg_tpcds__customer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:15.935332Z", "completed_at": "2023-12-29T02:08:15.940206Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:15.941782Z", "completed_at": "2023-12-29T02:08:15.941793Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009486913681030273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.stg_tpcds__customer_address", "compiled": true, "compiled_code": "select \n    CA_STREET_NAME AS STREET_NAME, \n    CA_SUITE_NUMBER AS SUITE_NUMBER, \n    CA_STATE AS STATE, \n    CA_LOCATION_TYPE AS LOCATION_TYPE, \n    CA_ADDRESS_SK AS ADDRESS_SK, \n    CA_COUNTRY AS COUNTRY, \n    CA_ADDRESS_ID AS ADDRESS_ID, \n    CA_COUNTY AS COUNTY, \n    CA_STREET_NUMBER AS STREET_NUMBER, \n    CA_ZIP AS ZIP, \n    CA_CITY AS CITY, \n    CA_STREET_TYPE AS STREET_TYPE, \n    CA_GMT_OFFSET AS GMT_OFFSET, \n    _AIRBYTE_NORMALIZED_AT AS DATETIMESTAMP\nfrom TPCDS.RAW.customer_address", "relation_name": "dbt_tpcds.staging.stg_tpcds__customer_address"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:15.946605Z", "completed_at": "2023-12-29T02:08:15.953223Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:15.955130Z", "completed_at": "2023-12-29T02:08:15.955143Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011487245559692383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.stg_tpcds__customer_demographics", "compiled": true, "compiled_code": "select \n    CD_DEP_EMPLOYED_COUNT as DEP_EMPLOYED_COUNT, \n    CD_DEMO_SK AS DEMO_SK, \n    CD_DEP_COUNT AS DEP_COUNT, \n    CD_CREDIT_RATING AS CREDIT_RATING, \n    CD_EDUCATION_STATUS AS EDUCATION_STATUS, \n    CD_PURCHASE_ESTIMATE AS PURCHASE_ESTIMATE, \n    CD_MARITAL_STATUS AS MARITAL_STATUS, \n    CD_DEP_COLLEGE_COUNT AS DEP_COLLEGE_COUNT, \n    CD_GENDER AS GENDER,\n    _AIRBYTE_NORMALIZED_AT AS DATETIMESTAMP\nfrom TPCDS.RAW.customer_demographics", "relation_name": "dbt_tpcds.staging.stg_tpcds__customer_demographics"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:15.959872Z", "completed_at": "2023-12-29T02:08:15.964549Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:15.966104Z", "completed_at": "2023-12-29T02:08:15.966116Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009148120880126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.stg_tpcds__date_dim", "compiled": true, "compiled_code": "select \n    D_DATE_ID as DATE_ID, \n    CAL_DT, \n    DAY_OF_WK_DESC, \n    WK_NUM, MNTH_NUM, \n    YR_MNTH_NUM, \n    D_DATE_SK as DATE_SK, \n    YR_NUM, \n    DAY_OF_WK_NUM, \n    YR_WK_NUM,  \n    _AIRBYTE_NORMALIZED_AT AS DATETIMESTAMP\nFROM TPCDS.RAW.date_dim", "relation_name": "dbt_tpcds.staging.stg_tpcds__date_dim"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:15.970862Z", "completed_at": "2023-12-29T02:08:15.975502Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:15.977034Z", "completed_at": "2023-12-29T02:08:15.977045Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009139299392700195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.stg_tpcds__household_demographics", "compiled": true, "compiled_code": "select \n    HD_BUY_POTENTIAL AS BUY_POTENTIAL, \n    HD_INCOME_BAND_SK AS INCOME_BAND_SK, \n    HD_DEMO_SK AS DEMO_SK, \n    HD_DEP_COUNT AS DEP_COUNT, \n    HD_VEHICLE_COUNT AS VEHICLE_COUNT, \n    _AIRBYTE_NORMALIZED_AT AS DATETIMESTAMP\nfrom TPCDS.RAW.household_demographics", "relation_name": "dbt_tpcds.staging.stg_tpcds__household_demographics"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:15.981765Z", "completed_at": "2023-12-29T02:08:15.986613Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:15.988143Z", "completed_at": "2023-12-29T02:08:15.988156Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009283065795898438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.stg_tpcds__income_band", "compiled": true, "compiled_code": "select \n    IB_LOWER_BOUND AS LOWER_BOUND, \n    IB_INCOME_BAND_SK AS INCOME_BAND_SK, \n    IB_UPPER_BOUND AS UPPER_BOUND, \n    _AIRBYTE_NORMALIZED_AT AS DATETIMESTAMP\nfrom TPCDS.RAW.income_band", "relation_name": "dbt_tpcds.staging.stg_tpcds__income_band"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:15.993038Z", "completed_at": "2023-12-29T02:08:15.997727Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:15.999285Z", "completed_at": "2023-12-29T02:08:15.999296Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009154081344604492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.stg_tpcds__inventory", "compiled": true, "compiled_code": "select \n    INV_DATE_SK, \n    INV_ITEM_SK,\n    INV_QUANTITY_ON_HAND AS QUANTITY_ON_HAND, \n    INV_WAREHOUSE_SK,\n    current_timestamp as DATETIMESTAMP\nfrom TPCDS.RAW.inventory", "relation_name": "dbt_tpcds.staging.stg_tpcds__inventory"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.004197Z", "completed_at": "2023-12-29T02:08:16.010428Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.011990Z", "completed_at": "2023-12-29T02:08:16.012005Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010807514190673828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.stg_tpcds__ship_mode", "compiled": true, "compiled_code": "select \n    SM_SHIP_MODE_SK as SHIP_MODE_SK, \n    SM_TYPE AS SHIP_MODE_TYPE, \n    SM_CODE AS SHIP_MODE_CODE, \n    SM_CARRIER AS CARRIER, \n    SM_CONTRACT, \n    SM_SHIP_MODE_ID AS SHIP_MODE_ID, \n    _AIRBYTE_NORMALIZED_AT AS DATETIMESTAMP\nfrom TPCDS.RAW.ship_mode", "relation_name": "dbt_tpcds.staging.stg_tpcds__ship_mode"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.016785Z", "completed_at": "2023-12-29T02:08:16.024041Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.025612Z", "completed_at": "2023-12-29T02:08:16.025627Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011816978454589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.stg_tpcds__warehouse", "compiled": true, "compiled_code": "select \n    W_ZIP AS ZIP, \n    W_WAREHOUSE_NAME AS WAREHOUSE_NAME, \n    W_STREET_NAME AS STREET_NAME, \n    W_STATE AS STATE, \n    W_CITY AS CITY, \n    W_COUNTY AS COUNTY, \n    W_STREET_TYPE AS STREET_TYPE, \n    W_WAREHOUSE_SQ_FT AS WAREHOUSE_SQ_FT, \n    W_SUITE_NUMBER AS SUITE_NUMBER, \n    W_STREET_NUMBER AS STREET_NUMBER, \n    W_COUNTRY AS COUNTRY, \n    W_WAREHOUSE_SK AS WAREHOUSE_SK, \n    W_GMT_OFFSET AS GMT_OFFSET, \n    W_WAREHOUSE_ID AS WAREHOUSE_ID,  \n    _AIRBYTE_NORMALIZED_AT AS DATETIMESTAMP\nfrom TPCDS.RAW.warehouse", "relation_name": "dbt_tpcds.staging.stg_tpcds__warehouse"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.030748Z", "completed_at": "2023-12-29T02:08:16.036049Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.037596Z", "completed_at": "2023-12-29T02:08:16.037610Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010133028030395508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.stg_tpcds__web_sales", "compiled": true, "compiled_code": "select \n    WS_ORDER_NUMBER AS ORDER_NUMBER, \n    WS_SHIP_MODE_SK AS SHIP_MODE_SK, \n    WS_SOLD_TIME_SK AS SOLD_TIME_SK, \n    WS_SHIP_ADDR_SK AS SHIP_ADDR_SK, \n    WS_NET_PAID_INC_TAX AS NET_PAID_INC_TAX, \n    WS_PROMO_SK AS PROMO_SK, \n    WS_NET_PAID_INC_SHIP AS NET_PAID_INC_SHIP, \n    WS_QUANTITY AS QUANTITY, \n    WS_EXT_SALES_PRICE AS EXT_SALES_PRICE, \n    WS_WEB_SITE_SK AS WEB_SITE_SK, \n    WS_SHIP_DATE_SK AS SHIP_DATE_SK, \n    WS_BILL_CDEMO_SK AS BILL_CDEMO, \n    WS_NET_PROFIT AS NET_PROFIT, \n    WS_NET_PAID AS NET_PAID, \n    WS_EXT_SHIP_COST AS EXT_SHIP_COST, \n    WS_BILL_CUSTOMER_SK AS BILL_CUSTOMER_SK, \n    WS_COUPON_AMT AS COUPON_AMT, \n    WS_WHOLESALE_COST AS WHOLESALE_COST, \n    WS_SHIP_CUSTOMER_SK AS SHIP_CUSTOMER_SK, \n    WS_BILL_HDEMO_SK AS BILL_HDEMO_SK, \n    WS_SOLD_DATE_SK AS SOLD_DATE_SK, \n    WS_SHIP_CDEMO_SK AS SHIP_CDEMO_SK, \n    WS_WAREHOUSE_SK AS WAREHOUSE_SK, \n    WS_EXT_TAX AS EXT_TAX, \n    WS_ITEM_SK AS ITEM_SK, \n    WS_SHIP_HDEMO_SK AS SHIP_HDEMO_SK, \n    WS_EXT_WHOLESALE_COST AS EXT_WHOLESALE_COST, \n    WS_NET_PAID_INC_SHIP_TAX AS NET_PAID_INC_SHIP_TAX, \n    WS_EXT_DISCOUNT_AMT AS EXT_DISCOUNT_AMT, \n    WS_SALES_PRICE AS SALES_PRICE, \n    WS_WEB_PAGE_SK AS WEB_PAGE_SK, \n    WS_EXT_LIST_PRICE AS EXT_LIST_PRICE, \n    WS_LIST_PRICE AS LIST_PRICE, \n    WS_BILL_ADDR_SK AS BILL_ADDR_SK, \n    _AIRBYTE_NORMALIZED_AT AS DATETIMESTAMP \nfrom TPCDS.RAW.web_sales", "relation_name": "dbt_tpcds.staging.stg_tpcds__web_sales"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.042597Z", "completed_at": "2023-12-29T02:08:16.045266Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.046819Z", "completed_at": "2023-12-29T02:08:16.046832Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007223844528198242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.midtermKuuku.field_eng_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.051805Z", "completed_at": "2023-12-29T02:08:16.056891Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.058580Z", "completed_at": "2023-12-29T02:08:16.058595Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009778499603271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.midtermKuuku.warehouse3_efficiency_snapshot", "compiled": true, "compiled_code": "\n\n    \n\n    select * from dbt_tpcds.working.field_eng_data\n", "relation_name": "DBT_TPCDS.marts.warehouse3_efficiency_snapshot"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.063421Z", "completed_at": "2023-12-29T02:08:16.068220Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.069765Z", "completed_at": "2023-12-29T02:08:16.069785Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009348869323730469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.midtermKuuku.customer_snapshot", "compiled": true, "compiled_code": "\n    \n    select * from dbt_tpcds.staging.stg_tpcds__customer \n    -- ref function to reference a 'previous model'", "relation_name": "dbt_tpcds.intermediate.customer_snapshot"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.074738Z", "completed_at": "2023-12-29T02:08:16.169171Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.170814Z", "completed_at": "2023-12-29T02:08:16.170829Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09910702705383301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.int_sales__daily_aggregated_sales", "compiled": true, "compiled_code": "\n\nwith incremental_sales as (\nSELECT \n        WAREHOUSE_SK,\n        ITEM_SK,\n        SOLD_DATE_SK,\n        QUANTITY,\n        sales_price * quantity as sales_amt,\n        NET_PROFIT\n    from dbt_tpcds.staging.stg_tpcds__catalog_sales\n    WHERE \n    quantity is not null and sales_amt is not null -- to filter out bad data. business specified\n    \n    union --in order to get sales from both catalog and web\n\n    SELECT \n            WAREHOUSE_SK,\n            ITEM_SK,\n            SOLD_DATE_SK,\n            QUANTITY,\n            sales_price * quantity as sales_amt,\n            NET_PROFIT\n    from dbt_tpcds.staging.stg_tpcds__web_sales\n    WHERE \n    quantity is not null and sales_amt is not null\n), \n\naggregating_records_to_daily_sales as\n(\nselect \n    warehouse_sk,\n    item_sk,\n    sold_date_sk, \n    sum(quantity) as daily_qty,\n    sum(sales_amt) as daily_sales_amt,\n    sum(net_profit) as daily_profit \nfrom incremental_sales\ngroup by 1, 2, 3\n\n),\n\nadding_week_number_and_yr_number as\n(\nselect \n    *,\n    date.wk_num as sold_wk_num,\n    date.yr_num as sold_yr_num\nfrom aggregating_records_to_daily_sales \nLEFT JOIN dbt_tpcds.staging.stg_tpcds__date_dim date\n    ON sold_date_sk = date.date_sk\n)\n\nSELECT \n\twarehouse_sk,\n    item_sk,\n    sold_date_sk,\n    max(sold_wk_num) as sold_wk_num,\n    max(sold_yr_num) as sold_yr_num,\n    sum(daily_qty) as daily_qty,\n    sum(daily_sales_amt) as daily_sales_amt,\n    sum(daily_profit) as daily_profit \nFROM adding_week_number_and_yr_number\n\nWHERE sold_date_sk >= (select max(sold_date_sk) from dbt_tpcds.intermediate.int_sales__daily_aggregated_sales)\n \n--only grabbing records after max sold date, nvl zero if null \nGROUP BY warehouse_sk,item_sk,sold_date_sk\nORDER BY warehouse_sk,item_sk,sold_date_sk\n\n-- incremental filter only applies if data exists in table", "relation_name": "dbt_tpcds.intermediate.int_sales__daily_aggregated_sales"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.175838Z", "completed_at": "2023-12-29T02:08:16.183113Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.184677Z", "completed_at": "2023-12-29T02:08:16.184689Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011885643005371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.int_sales__daily_shipped_web_sales", "compiled": true, "compiled_code": "\n\nwith initial_sales_cte as (\n    select \n        item_sk,\n        ship_date_sk,\n        ship_addr_sk,\n        ship_mode_sk,\n        sum(ext_ship_cost) as ship_cost,\n        sum(quantity) as quantity,\n        sum(net_profit) as net_profit\n    from dbt_tpcds.staging.stg_tpcds__web_sales\n    WHERE QUANTITY IS NOT null\n    group by item_sk,ship_date_sk,ship_addr_sk,ship_mode_sk\n),\n\nsecondcte_aggregation as (\n    select \n        *,\n        date.yr_num as shipped_year,\n        date.mnth_num as shipped_month,\n        date.yr_mnth_num as shipped_year_month\n    from initial_sales_cte\n    left join dbt_tpcds.staging.stg_tpcds__date_dim date\n    on date.date_sk = ship_date_sk\n)\nselect \n        item_sk,\n        ship_date_sk,\n        ship_addr_sk,\n        ship_mode_sk,\n        sum(ship_cost) as ship_cost,\n        sum(quantity) as quantity,\n        sum(net_profit) as net_profit,\n        max(shipped_year) as shipped_year,\n        max(shipped_month) as shipped_month,\n        max(shipped_year_month) as shipped_year_month\nfrom secondcte_aggregation\n\nWHERE ship_date_sk >= (select max(ship_date_sk) from dbt_tpcds.intermediate.int_sales__daily_shipped_web_sales)\n \ngroup by item_sk,ship_date_sk,ship_addr_sk,ship_mode_sk\norder by item_sk,ship_date_sk,ship_addr_sk,ship_mode_sk", "relation_name": "dbt_tpcds.intermediate.int_sales__daily_shipped_web_sales"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.189619Z", "completed_at": "2023-12-29T02:08:16.627110Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.628731Z", "completed_at": "2023-12-29T02:08:16.628749Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.48372364044189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.midtermKuuku.dbt_expectations_expect_column_to_exist_field_eng_data_efficiency.0e7216df59", "compiled": true, "compiled_code": "\n\n    with test_data as (\n\n        select\n            cast('EFFICIENCY' as TEXT) as column_name,\n            4 as matching_column_index,\n            True as column_index_matches\n\n    )\n    select *\n    from test_data\n    where\n        not(matching_column_index >= 0 and column_index_matches)", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.675657Z", "completed_at": "2023-12-29T02:08:16.690932Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.692546Z", "completed_at": "2023-12-29T02:08:16.692562Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019989728927612305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.midtermKuuku.not_null_field_eng_data_warehouse_id.d860be0f29", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect warehouse_id\nfrom DBT_TPCDS.working.field_eng_data\nwhere warehouse_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.697455Z", "completed_at": "2023-12-29T02:08:16.704468Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.706038Z", "completed_at": "2023-12-29T02:08:16.706051Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011585235595703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.dim_customer", "compiled": true, "compiled_code": "\n\nselect cs.*, \n    ca.STREET_NAME, ca.SUITE_NUMBER, ca.STATE, ca.LOCATION_TYPE, ca.COUNTRY, \n    ca.ADDRESS_ID, ca.COUNTY, ca.STREET_NUMBER, ca.ZIP, ca.CITY, ca.STREET_TYPE, ca.GMT_OFFSET, \n    cd.DEP_EMPLOYED_COUNT, cd.CREDIT_RATING, cd.EDUCATION_STATUS, \n    cd.PURCHASE_ESTIMATE, cd.MARITAL_STATUS, cd.DEP_COLLEGE_COUNT, cd.GENDER,\n    hd.BUY_POTENTIAL, hd.DEP_COUNT, hd.VEHICLE_COUNT, ib.LOWER_BOUND, ib.INCOME_BAND_SK, ib.UPPER_BOUND \nfrom dbt_tpcds.intermediate.customer_snapshot as cs\nLEFT join dbt_tpcds.staging.stg_tpcds__customer_address as ca on ca.ADDRESS_SK = cs.CURRENT_ADDR_SK \nLEFT join dbt_tpcds.staging.stg_tpcds__customer_demographics as cd ON cd.DEMO_SK = cs.CURRENT_CDEMO_SK\nLEFT join dbt_tpcds.staging.stg_tpcds__household_demographics as hd ON hd.DEMO_SK = cs.CURRENT_HDEMO\nLEFT join dbt_tpcds.staging.stg_tpcds__income_band as ib ON ib.INCOME_BAND_SK = hd.INCOME_BAND_SK \nWHERE cs.dbt_valid_from is null --comment out where clause for initial load", "relation_name": "dbt_tpcds.marts.dim_customer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.711056Z", "completed_at": "2023-12-29T02:08:16.718855Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.720402Z", "completed_at": "2023-12-29T02:08:16.720415Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012319087982177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.weekly_sales_inventory", "compiled": true, "compiled_code": "\n\nwith aggregating_daily_sales_to_week as (\nSELECT \n    WAREHOUSE_SK, \n    ITEM_SK,\n    MIN(SOLD_DATE_SK) AS SOLD_WK_SK, --beginning of the week\n    SOLD_WK_NUM,\n    SOLD_YR_NUM, \n    SUM(DAILY_QTY) AS SUM_QTY_WK, \n    SUM(DAILY_SALES_AMT) AS SUM_AMT_WK, \n    SUM(DAILY_PROFIT) AS SUM_PROFIT_WK\nFROM\n    dbt_tpcds.intermediate.int_sales__daily_aggregated_sales\nGROUP BY\n    warehouse_sk,item_sk,sold_wk_num,sold_yr_num\n),\n\nfinding_first_date_of_the_week as (\nSELECT \n    WAREHOUSE_SK, \n    ITEM_SK, \n    date.date_sk AS SOLD_WK_SK, \n    SOLD_WK_NUM, \n    SOLD_YR_NUM, \n    SUM_QTY_WK, \n    SUM_AMT_WK, \n    SUM_PROFIT_WK\nFROM\n    aggregating_daily_sales_to_week as daily_sales\nINNER JOIN dbt_tpcds.staging.stg_tpcds__date_dim as date --inner join to 'normalize' weeks \n-- that dont have sales on first date\non daily_sales.SOLD_WK_NUM=date.wk_num\nand daily_sales.sold_yr_num=date.yr_num\nand date.day_of_wk_num=0\n),\n\npopulating_friday_date_for_the_week as (\nSELECT \n    *,\n    date.date_sk as friday_sk\nFROM\n    finding_first_date_of_the_week as ffw\nINNER JOIN dbt_tpcds.staging.stg_tpcds__date_dim as date\non ffw.SOLD_WK_NUM=date.wk_num\nand ffw.sold_yr_num=date.yr_num\nand date.day_of_wk_num=5\n)\n\nselect \n       warehouse_sk, \n       item_sk, \n       max(SOLD_WK_SK) as sold_wk_sk,\n       sold_wk_num,\n       sold_yr_num,\n       sum(sum_qty_wk) as sum_qty_wk,\n       sum(sum_amt_wk) as sum_amt_wk,\n       sum(sum_profit_wk) as sum_profit_wk,\n       sum(sum_qty_wk)/7 as avg_qty_dy,\n       sum(nvl(inv.quantity_on_hand, 0)) as inv_qty_wk, \n       sum(nvl(inv.quantity_on_hand, 0)) / sum(sum_qty_wk) as wks_sply,\n       iff(avg_qty_dy>0 and avg_qty_dy>inv_qty_wk, true , false) as low_stock_flg_wk\nfrom populating_friday_date_for_the_week\nleft join dbt_tpcds.staging.stg_tpcds__inventory inv \n    on inv.inv_date_sk = friday_sk and item_sk = inv.inv_item_sk and inv.inv_warehouse_sk = warehouse_sk\ngroup by warehouse_sk,item_sk,sold_wk_num,sold_yr_num,sold_wk_sk\n-- extra precaution because to avoid negative or zero quantities in our final model\nhaving sum(sum_qty_wk) > 0\nand sold_wk_sk >= (select max(nvl(sold_wk_sk,0)) from dbt_tpcds.marts.weekly_sales_inventory) \n\n--  inventory table gets populated every friday thus join with friday_sk", "relation_name": "dbt_tpcds.marts.weekly_sales_inventory"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.725312Z", "completed_at": "2023-12-29T02:08:16.732045Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.733591Z", "completed_at": "2023-12-29T02:08:16.733603Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011233091354370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.midtermKuuku.monthly_web_sales_profit", "compiled": true, "compiled_code": "\n\nwith aggregating_daily_sales_to_month as (\n    select \n        item_sk,\n        ship_addr_sk,\n        ship_mode_sk,\n        min(ship_date_sk) as ship_date_sk,\n        sum(ship_cost) as ship_cost,\n        sum(quantity) as quantity,\n        sum(net_profit) as net_profit,\n        max(shipped_year) as shipped_year,\n        max(shipped_month) as shipped_month,\n        shipped_year_month as ship_mnth_sk\n    from dbt_tpcds.intermediate.int_sales__daily_shipped_web_sales\n    group by item_sk,ship_mnth_sk,ship_addr_sk,ship_mode_sk\n    ),\n\nnormalize_for_month as (\n    select \n        *,\n        date.date_sk as ship_date_sk\n    from aggregating_daily_sales_to_month as monthly_sales\n    inner join dbt_tpcds.staging.stg_tpcds__date_dim as date\n    on monthly_sales.ship_mnth_sk = date.yr_mnth_num\n)\nselect \n    item_sk,\n    ship_addr_sk,\n    ship_mode_sk,\n    sum(ship_cost) as ship_cost,\n    sum(quantity) as quantity,\n    sum(net_profit) as net_profit,\n    max(shipped_year) as shipped_year,\n    max(shipped_month) as shipped_month,\n    ship_mnth_sk\nfrom normalize_for_month\n\n    where ship_mnth_sk >= (select max(coalesce(ship_mnth_sk,0)) from dbt_tpcds.marts.monthly_web_sales_profit)\n\ngroup by ship_mnth_sk,ship_addr_sk,ship_mode_sk,item_sk", "relation_name": "dbt_tpcds.marts.monthly_web_sales_profit"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.738408Z", "completed_at": "2023-12-29T02:08:16.745286Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.746854Z", "completed_at": "2023-12-29T02:08:16.746866Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011406421661376953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.midtermKuuku.not_null_dim_customer_CUSTOMER_SK.b46c6eaaeb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CUSTOMER_SK\nfrom dbt_tpcds.marts.dim_customer\nwhere CUSTOMER_SK is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.751647Z", "completed_at": "2023-12-29T02:08:16.765605Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.767205Z", "completed_at": "2023-12-29T02:08:16.767218Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018691301345825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.midtermKuuku.relationships_dim_customer_CUSTOMER_SK__CUSTOMER_SK__ref_stg_tpcds__customer_.b648937286", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select CUSTOMER_SK as from_field\n    from dbt_tpcds.marts.dim_customer\n    where CUSTOMER_SK is not null\n),\n\nparent as (\n    select CUSTOMER_SK as to_field\n    from dbt_tpcds.staging.stg_tpcds__customer\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.772174Z", "completed_at": "2023-12-29T02:08:16.779394Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.780955Z", "completed_at": "2023-12-29T02:08:16.780968Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011768102645874023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.midtermKuuku.accepted_values_weekly_sales_inventory_low_stock_flg_wk__True__False.3fe9d402b7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        low_stock_flg_wk as value_field,\n        count(*) as n_records\n\n    from dbt_tpcds.marts.weekly_sales_inventory\n    group by low_stock_flg_wk\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'True','False'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-29T02:08:16.785793Z", "completed_at": "2023-12-29T02:08:16.792498Z"}, {"name": "execute", "started_at": "2023-12-29T02:08:16.794239Z", "completed_at": "2023-12-29T02:08:16.794251Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01149892807006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.midtermKuuku.not_null_weekly_sales_inventory_inv_qty_wk.8b431c0745", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect inv_qty_wk\nfrom dbt_tpcds.marts.weekly_sales_inventory\nwhere inv_qty_wk is null\n\n\n", "relation_name": null}], "elapsed_time": 3.444570541381836, "args": {"partial_parse": true, "quiet": false, "enable_legacy_logger": false, "indirect_selection": "eager", "exclude": [], "version_check": true, "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "project_dir": "/home/ubuntu/dbt/midtermKuuku", "log_level": "info", "send_anonymous_usage_stats": true, "profiles_dir": "/home/ubuntu/.dbt", "cache_selected_only": false, "populate_cache": true, "show_resource_report": false, "macro_debugging": false, "log_path": "/home/ubuntu/dbt/midtermKuuku/logs", "printer_width": 80, "select": [], "which": "generate", "log_level_file": "debug", "write_json": true, "invocation_command": "dbt docs generate", "log_format_file": "debug", "introspect": true, "partial_parse_file_diff": true, "static_parser": true, "strict_mode": false, "compile": true, "defer": false, "favor_state": false, "log_file_max_bytes": 10485760, "vars": {}, "print": true, "log_format": "default", "use_colors": true, "empty_catalog": false, "static": false}}